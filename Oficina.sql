-- MySQL Script generated by MySQL Workbench
-- Wed Sep 21 18:26:53 2022
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`VEICULO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`VEICULO` (
  `ID_VEICULO` INT NOT NULL,
  `PLACA` CHAR(8) NULL,
  `COR` VARCHAR(45) NULL,
  `MODELO` VARCHAR(45) NULL,
  `MARCA` VARCHAR(45) NULL,
  `ANO` INT NULL,
  PRIMARY KEY (`ID_VEICULO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`CLIENTES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`CLIENTES` (
  `ID_CLIENTE` INT NOT NULL AUTO_INCREMENT,
  `NOME` VARCHAR(45) NULL,
  `ENDERECO` VARCHAR(45) NULL,
  `CPF` CHAR(11) NULL,
  `Veiculo_idVeiculo` INT NOT NULL,
  PRIMARY KEY (`ID_CLIENTE`, `Veiculo_idVeiculo`),
  CONSTRAINT `fk_Clientes_Veiculo1`
    FOREIGN KEY (`Veiculo_idVeiculo`)
    REFERENCES `mydb`.`VEICULO` (`ID_VEICULO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_Clientes_Veiculo1_idx` ON `mydb`.`CLIENTES` (`Veiculo_idVeiculo` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `mydb`.`MECANICO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`MECANICO` (
  `ID_MECANICO` INT NOT NULL,
  `NOME` VARCHAR(45) NULL,
  `ESPECIALIDADE` VARCHAR(45) NULL,
  PRIMARY KEY (`ID_MECANICO`))
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `mydb`.`TIPO_SERVICO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`TIPO_SERVICO` (
  `ID_TIPOSERVICO` INT NOT NULL,
  `DS_SERVICO` VARCHAR(45) NULL,
  PRIMARY KEY (`ID_TIPOSERVICO`))
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `mydb`.`ORDEM_SERVICO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ORDEM_SERVICO` (
  `ID_OS` INT NOT NULL,
  `VAL_PECAS` DECIMAL(10) NULL,
  `VAL_MAOOBRA` DECIMAL(10) NULL,
  `VAL_TOTAL` DECIMAL(10) NULL,
  `CLIENTES_ID_CLIENTE` INT NOT NULL,
  `MECANICO_ID_MECANICO` INT NOT NULL,
  `TIPO_SERVICO_ID_TIPOSERVICO` INT NOT NULL,
  `VEICULO_ID_VEICULO` INT NOT NULL,
  `AUTORIZADO` VARCHAR(10) NULL,
  `DT_ENTREGA` DATE NULL,
  PRIMARY KEY (`ID_OS`, `CLIENTES_ID_CLIENTE`, `MECANICO_ID_MECANICO`, `TIPO_SERVICO_ID_TIPOSERVICO`, `VEICULO_ID_VEICULO`),
  CONSTRAINT `fk_Ordem Serviçco_Clientes`
    FOREIGN KEY (`CLIENTES_ID_CLIENTE`)
    REFERENCES `mydb`.`CLIENTES` (`ID_CLIENTE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Ordem Serviçco_Equipe Mecanicos1`
    FOREIGN KEY (`MECANICO_ID_MECANICO`)
    REFERENCES `mydb`.`MECANICO` (`ID_MECANICO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Ordem Serviçco_Tipo Serviçco1`
    FOREIGN KEY (`TIPO_SERVICO_ID_TIPOSERVICO`)
    REFERENCES `mydb`.`TIPO_SERVICO` (`ID_TIPOSERVICO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Ordem Serviçco_Veiculo1`
    FOREIGN KEY (`VEICULO_ID_VEICULO`)
    REFERENCES `mydb`.`VEICULO` (`ID_VEICULO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_Ordem Serviçco_Clientes_idx` ON `mydb`.`ORDEM_SERVICO` (`CLIENTES_ID_CLIENTE` ASC) VISIBLE;

CREATE INDEX `fk_Ordem Serviçco_Equipe Mecanicos1_idx` ON `mydb`.`ORDEM_SERVICO` (`MECANICO_ID_MECANICO` ASC) VISIBLE;

CREATE INDEX `fk_Ordem Serviçco_Tipo Serviçco1_idx` ON `mydb`.`ORDEM_SERVICO` (`TIPO_SERVICO_ID_TIPOSERVICO` ASC) VISIBLE;

CREATE INDEX `fk_Ordem Serviçco_Veiculo1_idx` ON `mydb`.`ORDEM_SERVICO` (`VEICULO_ID_VEICULO` ASC) VISIBLE;

-- -----------------------------------------------------
-- Table `mydb`.`PECAS`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`PECAS` (
  `ID_PECAS` INT NOT NULL,
  `DESCRICAO_PECA` VARCHAR(45) NULL,
  `VALOR_PECA` DECIMAL(10) NULL,
  PRIMARY KEY (`ID_PECAS`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`MAO_OBRA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`MAO_OBRA` (
  `ID_MAOOBRA` INT NOT NULL,
  `DS_MAOOBRA` VARCHAR(45) NULL,
  `VALOR_MAOOBRA` DECIMAL(10) NULL,
  PRIMARY KEY (`ID_MAOOBRA`))
ENGINE = InnoDB;

INSERT INTO VEICULO (ID_VEICULO, PLACA, COR, MODELO, MARCA, ANO) VALUES
('1', 'XXX-XXXX', 'BRANCO', 'CIVIC', 'HONDA', 2020);

INSERT INTO CLIENTES (ID_CLIENTE, NOME, ENDERECO, CPF, Veiculo_idVeiculo) VALUES
('1', 'GUSTAVO PEREIRA', 'RUA 1', '999.999.999-99', '1');

INSERT INTO MECANICO (ID_MECANICO, NOME, ESPECIALIDADE) VALUES
('1', 'GUSTAVO PEREIRA', 'MECANICO');

INSERT INTO TIPO_SERVICO (ID_TIPOSERVICO, DS_SERVICO) VALUES
('1', 'FUNILARIA');

INSERT INTO ORDEM_SERVICO (ID_OS, VAL_PECAS, VAL_MAOOBRA, VAL_TOTAL, CLIENTES_ID_CLIENTE, MECANICO_ID_MECANICO, TIPO_SERVICO_ID_TIPOSERVICO, VEICULO_ID_VEICULO, AUTORIZADO, DT_ENTREGA) VALUES
('1', '10', '10', '20', 1, 1, 1, 1, 'S', '21/09/2022');

INSERT INTO PECAS (ID_PECAS, DESCRICAO_PECA, VALOR_PECA) VALUES
(1, 'PNEU', 10);

INSERT INTO MAO_OBRA (ID_MAOOBRA, DS_MAOOBRA, VALOR_MAOOBRA) VALUES
('1', 'TROCA PNEU', 10);


-----------------------------------------------------
SELECT (ID_VEICULO, PLACA, COR, MODELO, MARCA, ANO)
  FROM VEICULO;

SELECT (ID_CLIENTE, NOME, ENDERECO, CPF, Veiculo_idVeiculo) 
FROM CLIENTES;

SELECT (ID_MECANICO, NOME, ESPECIALIDADE) 
FROM MECANICO

SELECT (ID_TIPOSERVICO, DS_SERVICO)
  FROM TIPO_SERVICO 

SELECT (ID_OS, VAL_PECAS, VAL_MAOOBRA, VAL_TOTAL, CLIENTES_ID_CLIENTE, MECANICO_ID_MECANICO, TIPO_SERVICO_ID_TIPOSERVICO, VEICULO_ID_VEICULO, AUTORIZADO, DT_ENTREGA) 
  FROM ORDEM_SERVICO;

SELECT (ID_PECAS, DESCRICAO_PECA, VALOR_PECA)
  FROM PECAS;

SELECT (ID_MAOOBRA, DS_MAOOBRA, VALOR_MAOOBRA)
  FROM MAO_OBRA;

-----------------------------------------------------

SELECT TB1.ID_OS,
       TB1.VAL_PECAS, 
       TB1.VAL_MAOOBRA, 
       TB1.VAL_TOTAL, 
       TB3.NOME,
       TB2.PLACA, 
       TB1.AUTORIZADO, 
       TB1.DT_ENTREGA
  FROM ORDEM_SERVICO TB1,
       VEICULO       TB2,
       CLIENTES      TB3
 WHERE TB1.VEICULO_ID_VEICULO = TB2.ID_VEICULO
   AND TB1.CLIENTES_ID_CLIENTE = TB3.CLIENTES
;

